!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";function e(e){return!e.nodeName||-1!==t.inArray(e.nodeName.toLowerCase(),["iframe","#document","html","body"])}function o(e){return t.isFunction(e)||t.isPlainObject(e)?e:{top:e,left:e}}var n=t.scrollTo=function(e,o,n){return t(window).scrollTo(e,o,n)};return n.defaults={axis:"xy",duration:0,limit:!0},t.fn.scrollTo=function(r,i,a){"object"==typeof i&&(a=i,i=0),"function"==typeof a&&(a={onAfter:a}),"max"===r&&(r=9e9),a=t.extend({},n.defaults,a),i=i||a.duration;var s=a.queue&&a.axis.length>1;return s&&(i/=2),a.offset=o(a.offset),a.over=o(a.over),this.each(function(){function l(e){var o=t.extend({},a,{queue:!0,duration:i,complete:e&&function(){e.call(h,p,a)}});d.animate(f,o)}if(null!==r){var c,u=e(this),h=u?this.contentWindow||window:this,d=t(h),p=r,f={};switch(typeof p){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(p)){p=o(p);break}p=u?t(p):t(p,h);case"object":if(0===p.length)return;(p.is||p.style)&&(c=(p=t(p)).offset())}var m=t.isFunction(a.offset)&&a.offset(h,p)||a.offset;t.each(a.axis.split(""),function(t,e){var o="x"===e?"Left":"Top",r=o.toLowerCase(),i="scroll"+o,v=d[i](),y=n.max(h,e);if(c)f[i]=c[r]+(u?0:v-d.offset()[r]),a.margin&&(f[i]-=parseInt(p.css("margin"+o),10)||0,f[i]-=parseInt(p.css("border"+o+"Width"),10)||0),f[i]+=m[r]||0,a.over[r]&&(f[i]+=p["x"===e?"width":"height"]()*a.over[r]);else{var g=p[r];f[i]=g.slice&&"%"===g.slice(-1)?parseFloat(g)/100*y:g}a.limit&&/^\d+$/.test(f[i])&&(f[i]=f[i]<=0?0:Math.min(f[i],y)),!t&&a.axis.length>1&&(v===f[i]?f={}:s&&(l(a.onAfterFirst),f={}))}),l(a.onAfter)}})},n.max=function(o,n){var r="x"===n?"Width":"Height",i="scroll"+r;if(!e(o))return o[i]-t(o)[r.toLowerCase()]();var a="client"+r,s=o.ownerDocument||o.document,l=s.documentElement,c=s.body;return Math.max(l[i],c[i])-Math.min(l[a],c[a])},t.Tween.propHooks.scrollLeft=t.Tween.propHooks.scrollTop={get:function(e){return t(e.elem)[e.prop]()},set:function(e){var o=this.get(e);if(e.options.interrupt&&e._last&&e._last!==o)return t(e.elem).stop();var n=Math.round(e.now);o!==n&&(t(e.elem)[e.prop](n),e._last=this.get(e))}},n}),function t(e,o,n){function r(a,s){if(!o[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=o[a]={exports:{}};e[a][0].call(u.exports,function(t){var o=e[a][1][t];return r(o?o:t)},u,u.exports,t,e,o,n)}return o[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(t,e,o){"use strict";function n(t){this.listenerMap=[{},{}],t&&this.root(t),this.handle=n.prototype.handle.bind(this)}function r(t,e){return t.toLowerCase()===e.tagName.toLowerCase()}function i(t,e){return this.rootElement===window?e===document:this.rootElement===e}function a(t,e){return t===e.id}e.exports=n,n.prototype.root=function(t){var e,o=this.listenerMap;if(this.rootElement){for(e in o[1])o[1].hasOwnProperty(e)&&this.rootElement.removeEventListener(e,this.handle,!0);for(e in o[0])o[0].hasOwnProperty(e)&&this.rootElement.removeEventListener(e,this.handle,!1)}if(!t||!t.addEventListener)return this.rootElement&&delete this.rootElement,this;this.rootElement=t;for(e in o[1])o[1].hasOwnProperty(e)&&this.rootElement.addEventListener(e,this.handle,!0);for(e in o[0])o[0].hasOwnProperty(e)&&this.rootElement.addEventListener(e,this.handle,!1);return this},n.prototype.captureForType=function(t){return-1!==["blur","error","focus","load","resize","scroll"].indexOf(t)},n.prototype.on=function(t,e,o,n){var l,c,u,h;if(!t)throw new TypeError("Invalid event type: "+t);if("function"==typeof e&&(n=o,o=e,e=null),void 0===n&&(n=this.captureForType(t)),"function"!=typeof o)throw new TypeError("Handler must be a type of Function");return l=this.rootElement,c=this.listenerMap[n?1:0],c[t]||(l&&l.addEventListener(t,this.handle,n),c[t]=[]),e?/^[a-z]+$/i.test(e)?(h=e,u=r):/^#[a-z0-9\-_]+$/i.test(e)?(h=e.slice(1),u=a):(h=e,u=s):(h=null,u=i.bind(this)),c[t].push({selector:e,handler:o,matcher:u,matcherParam:h}),this},n.prototype.off=function(t,e,o,n){var r,i,a,s,l;if("function"==typeof e&&(n=o,o=e,e=null),void 0===n)return this.off(t,e,o,!0),this.off(t,e,o,!1),this;if(a=this.listenerMap[n?1:0],!t){for(l in a)a.hasOwnProperty(l)&&this.off(l,e,o);return this}if(s=a[t],!s||!s.length)return this;for(r=s.length-1;r>=0;r--)i=s[r],e&&e!==i.selector||o&&o!==i.handler||s.splice(r,1);return s.length||(delete a[t],this.rootElement&&this.rootElement.removeEventListener(t,this.handle,n)),this},n.prototype.handle=function(t){var e,o,n,r,i,a,s,l=t.type,c=[],u="ftLabsDelegateIgnore";if(t[u]!==!0){switch(s=t.target,3===s.nodeType&&(s=s.parentNode),n=this.rootElement,r=t.eventPhase||(t.target!==t.currentTarget?3:2)){case 1:c=this.listenerMap[1][l];break;case 2:this.listenerMap[0]&&this.listenerMap[0][l]&&(c=c.concat(this.listenerMap[0][l])),this.listenerMap[1]&&this.listenerMap[1][l]&&(c=c.concat(this.listenerMap[1][l]));break;case 3:c=this.listenerMap[0][l]}for(o=c.length;s&&o;){for(e=0;o>e&&(i=c[e],i);e++)if(i.matcher.call(s,i.matcherParam,s)&&(a=this.fire(t,s,i)),a===!1)return t[u]=!0,void t.preventDefault();if(s===n)break;o=c.length,s=s.parentElement}}},n.prototype.fire=function(t,e,o){return o.handler.call(e,t,e)};var s=function(t){if(t){var e=t.prototype;return e.matches||e.matchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector}}(Element);n.prototype.destroy=function(){this.off(),this.root()}},{}],2:[function(t,e,o){"use strict";var n=t("./src/js/share"),r=function i(){n.init(),document.removeEventListener("o.DOMContentLoaded",i)};document.addEventListener("o.DOMContentLoaded",r),e.exports=n},{"./src/js/share":4}],3:[function(t,e,o){"use strict";function n(t,e){var o=document.createElement("canvas");if(o.getContext&&window.getComputedStyle){var n=o.getContext("2d"),r=window.getComputedStyle(e);return n.font=r.getPropertyValue("font-style")+" "+r.getPropertyValue("font-size")+" "+r.getPropertyValue("font-family"),n.fillText(t,10,100),n.measureText(t).width}return-1}function r(t){function e(t,e){var o=document.createElement("input");return o.setAttribute("type","text"),o.id=t+"__url",o.setAttribute("value",e),o}function o(t,e){var o=document.createElement("span");return o.className=t+"__text",o.innerHTML=e,o}function r(t){var e=document.createElement("div");return e.className=t,e}function a(){s.inputEl=e(l,t.text);var a=n(t.text,s.inputEl);-1!==a&&(s.inputEl.style.width=a+"px"),s.messageEl=o(l,t.message),s.tooltip=r(l),s.tooltip.appendChild(s.inputEl),s.tooltip.appendChild(s.messageEl),t.parentEl.appendChild(s.tooltip),s.inputEl.select(),s.config=t,s.bodyDomDelegate=new i(document.body),s.inputDomDelegate=new i(s.inputEl)}var s=this,l="o-share-tooltip";a(),this.bodyDomDelegate.on("click",function(e){t.parentEl.contains(e.target)||s.destroy()}),this.bodyDomDelegate.on("keydown",function(t){27!==t.keyCode&&9!==t.keyCode||s.destroy(),8===t.keyCode&&(t.stopImmediatePropagation(),t.preventDefault())}),this.inputDomDelegate.on("keypress",function(t){t.preventDefault()}),this.inputDomDelegate.on("copy",function(){s.messageEl.innerHTML="已复制!","function"==typeof t.onCopy&&t.onCopy()})}var i=t("./../../../dom-delegate/lib/delegate.js");r.prototype.destroy=function(){this.tooltip.removeChild(this.inputEl),this.inputEl=void 0,this.tooltip.removeChild(this.messageEl),this.messageEl=void 0,this.tooltip.parentElement.removeChild(this.tooltip),this.tooltip=void 0,this.bodyDomDelegate.destroy(),"function"==typeof this.config.onDestroy&&this.config.onDestroy()},e.exports=r},{"./../../../dom-delegate/lib/delegate.js":1}],4:[function(t,e,o){"use strict";function n(t,e){function o(){t?t instanceof HTMLElement||(t=document.querySelector(t)):t=document.body;var o=new r(t);o.on("click",c),t.setAttribute("data-o-share--js",""),d.rootDomDelegate=o,d.rootEl=t,0===t.children.length&&(e||(e={},e.links=t.hasAttribute("data-o-share-links")?t.getAttribute("data-o-share-links").split(" "):s.links,e.url=t.getAttribute("data-o-share-url")||s.url,e.title=t.getAttribute("data-o-share-title")||s.title,e.summray=t.getAttribute("data-o-share-summary")||s.summary),n());var i=new CustomEvent("oShare.ready",{detail:{share:d},bubbles:!0});d.rootEl.dispatchEvent(i)}function n(){for(var t=document.createElement("ul"),o=0;o<e.links.length;o++){var n=e.links[o],r=a[n].name,i=document.createElement("li");i.classList.add("o-share__action","o-share__action--"+n);var s=document.createElement("a");"url"!==n?s.href=l(n):s.href=e.url,s.setAttribute("data-link-tooltip",r);var c=document.createElement("i");c.innerHTML=r,s.appendChild(c),i.appendChild(s),t.appendChild(i)}d.rootEl.appendChild(t)}function l(t){var o=a[t].url;return o=o.replace("{{url}}",encodeURIComponent(e.url)).replace("{{title}}",encodeURIComponent(e.title)).replace("{{summary}}",encodeURIComponent(e.summary))}function c(t){var e=t.target.closest("li.o-share__action");if(d.rootEl.contains(e)&&e.querySelector("a[href]")){t.preventDefault();var o=e.querySelector("a[href]").href,n=new CustomEvent("oTracking.event",{detail:{category:"share",action:"click",button:e.textContent.trim()}});d.rootEl.dispatchEvent(n),e.classList.contains("o-share__action--url")?u(o,e):h(o)}}function u(t,e){t&&e&&!e.hasAttribute("aria-selected")&&(e.setAttribute("aria-selected","true"),new i({message:"分享此链接",text:t,parentEl:e,onCopy:function(){d.rootEl.dispatchEvent(new CustomEvent("oShare.copy",{detail:{share:d,action:"url",url:t}}))},onDestroy:function(){e.removeAttribute("aria-selected")}}),d.rootEl.dispatchEvent(new CustomEvent("oShare.open",{detail:{share:d,action:"url",url:t}})))}function h(t){t&&(p[t]&&!p[t].closed?p[t].focus():p[t]=window.open(t,"","width=646,height=436"),d.rootEl.dispatchEvent(new CustomEvent("oShare.open",{detail:{share:d,action:"social",url:t}})))}var d=this,p={};o()}var r=t("./../../../dom-delegate/lib/delegate.js"),i=t("./TextCopyHelper"),a={wechat:{name:"微信",url:"http://www.ftchinese.com/m/corp/qrshare.html?title={{title}}&url={{url}}&ccode=2C1A1408"},weibo:{name:"微博",url:"http://service.weibo.com/share/share.php?&appkey=4221537403&url={{url}}&title=【{{title}}】{{summary}}&ralateUid=1698233740&source=FT中文网&sourceUrl=http://www.ftchinese.com/&content=utf8&ccode=2G139005"},linkedin:{name:"领英",url:"http://www.linkedin.com/shareArticle?mini=true&url={{url}}&title={{title}}&summary={{summary}}&source=FT中文网"},facebook:{name:"Facebook",url:"http://www.facebook.com/sharer.php?u={{url}}"},twitter:{name:"Twitter",url:"https://twitter.com/intent/tweet?url={{url}}&amp;text={{title}}&amp;via=FTChinese"},url:{name:"复制链接",url:"{{url}}"}},s={links:["wechat","weibo","linkedin","facebook","twitter","url"],url:window.location.href||"",summary:function(){var t=document.querySelector('meta[property="og:description"]');return t&&t.hasAttribute("content")?t.getAttribute("content"):""}(),title:function(){var t=document.querySelector("title");if(t){var e=void 0!==t.textContent?t.textContent:t.innerText;return e.split("-")[0].trim()}return""}()};n.prototype.destroy=function(){this.rootDomDelegate.destroy();for(var t=0;t<this.rootEl.children;t++)this.rootEl.removeChild(this.rootEl.chidlren[t]);this.rootEl.removeAttribute("data-o-share--js"),this.rootEl=void 0},n.init=function(t){var e=[];t?!t instanceof HTMLElement&&(t=document.querySelector(t)):t=document.body;for(var o=t.querySelectorAll("[data-o-component=o-share]"),r=0;r<o.length;r++)o[r].hasAttribute("data-o-header--js")||e.push(new n(o[r]));return e};var l=Object.create(HTMLElement.prototype);n.Element=document.registerElement?document.registerElement("o-share",{prototype:l}):void 0,e.exports=n},{"./../../../dom-delegate/lib/delegate.js":1,"./TextCopyHelper":3}],5:[function(t,e,o){"use strict";function n(t,e){var o=e[t-1];o.addClass("active"),o.siblings().removeClass("active")}function r(t,e){for(var o=1,n=0;n<e.length;n++)t>=e[n]&&(o=n+1);return o}function i(t,e){try{ga("send","pageview",t+"?page="+e),fa("send","pageview",t+"?page="+e),ftcLog()}catch(o){}}function a(t){t.on("click",function(t){t.preventDefault(),$(window).scrollTo(0,1e3)})}function s(t){return t.map(function(){return $(this).offset().top})}function l(t,e){var o=[];return e.each(function(e){var n=$(this).attr("id"),r=$("<a/>",{href:"#"+n,click:function(t){t.preventDefault(),$(window).scrollTo(document.getElementById(n),300),$(t.target).addClass("active"),$(t.target).siblings().removeClass("active")}}).text(e+1);t.append(r),o.push(r)}),o}function c(t,e){$("body").on("load click touch",function(){e.addClass("hide-on-small")}),t.on("click touch",function(t){e.toggleClass("hide-on-small"),t.stopPropagation()})}var u=t("./../bower_components/ftc-share/main.js");u.init(),$(function(){var t=$(window),e=window.location.pathname,o=$(".header").height();$(window).height()-o,$(".nav__toc").eq(0);c($(".small-menu"),$(".nav__toc")),a($(".to-top"));var u=l($(".nav__toc"),$(".nav-target")),h=s($(".nav-target")).toArray(),d=t.scrollTop(),p=r(d,h),f=p;n(p,u),i(e,p),t.on("scroll",function(){var o=t.scrollTop(),a=r(o,h);f!==a&&(f=a,n(a,u),i(e,a))})})},{"./../bower_components/ftc-share/main.js":2}]},{},[5]);